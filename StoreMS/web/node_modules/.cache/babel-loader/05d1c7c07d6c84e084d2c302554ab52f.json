{"remainingRequest":"/Users/student02/Desktop/youduitong1/node_modules/babel-loader/lib/index.js!/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/student02/Desktop/youduitong1/src/pages/goodsDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/student02/Desktop/youduitong1/src/pages/goodsDetail.vue","mtime":1571129798000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.array.find-index\";\nimport _defineProperty from \"/Users/student02/Desktop/youduitong1/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"vant/es/stepper/style\";\nimport _Stepper from \"vant/es/stepper\";\nimport \"vant/es/goods-action-button/style\";\nimport _GoodsActionButton from \"vant/es/goods-action-button\";\nimport \"vant/es/goods-action-icon/style\";\nimport _GoodsActionIcon from \"vant/es/goods-action-icon\";\nimport \"vant/es/goods-action/style\";\nimport _GoodsAction from \"vant/es/goods-action\";\nimport \"vant/es/cell/style\";\nimport _Cell from \"vant/es/cell\";\nimport \"vant/es/cell-group/style\";\nimport _CellGroup from \"vant/es/cell-group\";\nimport \"vant/es/image/style\";\nimport _Image from \"vant/es/image\";\nimport \"vant/es/button/style\";\nimport _Button from \"vant/es/button\";\nimport \"vant/es/col/style\";\nimport _Col from \"vant/es/col\";\nimport \"vant/es/row/style\";\nimport _Row from \"vant/es/row\";\nimport \"vant/es/icon/style\";\nimport _Icon from \"vant/es/icon\";\nimport \"core-js/modules/es6.function.name\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\n\nvar _components;\n\nimport { Images } from '@/resources/index.js';\nexport default {\n  components: (_components = {}, _defineProperty(_components, _NavBar.name, _NavBar), _defineProperty(_components, _Icon.name, _Icon), _defineProperty(_components, _Row.name, _Row), _defineProperty(_components, _Col.name, _Col), _defineProperty(_components, _Button.name, _Button), _defineProperty(_components, _Image.name, _Image), _defineProperty(_components, _CellGroup.name, _CellGroup), _defineProperty(_components, _Cell.name, _Cell), _defineProperty(_components, _GoodsAction.name, _GoodsAction), _defineProperty(_components, _GoodsActionIcon.name, _GoodsActionIcon), _defineProperty(_components, _GoodsActionButton.name, _GoodsActionButton), _defineProperty(_components, _Stepper.name, _Stepper), _defineProperty(_components, _Toast.name, _Toast), _components),\n  data: function data() {\n    return {\n      backImg: Images.shop.ic_back,\n      goodsDetail: '',\n      showTab: false,\n      icon: Images.shop.ic_item,\n      goodsNum: 1,\n      comments: 0,\n      allComments: [],\n      upArrow: Images.common.ic_up_arrow\n    };\n  },\n  methods: {\n    goBack: function goBack() {\n      this.$store.commit('changeTabbarActive', this.$store.state.fromPage);\n      this.$router.back();\n    },\n    getAllComments: function getAllComments(count) {\n      var _this = this;\n\n      var url = '/order/getProductComment?product_id=' + this.goodsDetail.ID + '&page=' + count;\n      this.axios.get(url).then(function (response) {\n        if (response.data.status === 1) {\n          _this.$store.commit(\"allComments\", response.data.obj);\n\n          _this.allComments = response.data.obj;\n        }\n      }).catch(function (response) {\n        _Toast(\"网络请求出错\");\n      });\n    },\n    onCartClick: function onCartClick() {\n      this.$router.push('/cart');\n    },\n    onAddToCart: function onAddToCart() {\n      var _this2 = this;\n\n      var url = '/cart/add?user_id=' + this.$store.state.userID + '&product_id=' + this.goodsDetail.ID + '&quantity=' + this.goodsNum + '&token=' + this.$store.state.token; // var data = {\n      // \tuser_id:this.$store.state.userID,\n      // \tProductID:this.goodsDetail.ID,\n      // \tQuantity:this.goodsNum,\n      // \tChecked:true\n      // }\n\n      this.axios.get(url).then(function (response) {\n        if (response.data.detail && response.data.detail === 'token异常，重新登陆') {\n          _Toast('登陆过期，请重新登录');\n\n          _this2.$router.push('/login');\n        } else if (response.data.status === 1) {\n          _this2.updateCartScreen();\n\n          _Toast(\"添加成功\");\n        } else {\n          _Toast(\"添加失败，请重试\");\n        }\n      }).catch(function (response) {\n        _Toast('网络请求出错，请重试');\n      });\n    },\n    onBuyClick: function onBuyClick() {\n      var data = {\n        MainImage: this.goodsDetail.MainImage,\n        Name: this.goodsDetail.Name,\n        goodsNum: this.goodsNum,\n        Price: this.goodsDetail.Price,\n        goodsID: this.goodsDetail.ID,\n        Stock: this.goodsDetail.Stock\n      };\n      this.$store.commit('confirmOrder', data);\n      this.$router.push('/confirmOrder');\n    },\n    handleScroll: function handleScroll() {\n      var scrollY = document.documentElement.scrollTop || document.body.scrollTop;\n\n      if (scrollY > 200) {\n        this.showTab = true;\n      } else {\n        this.showTab = false;\n      }\n    },\n    scrollTop: function scrollTop() {\n      var top = document.documentElement.scrollTop || document.body.scrollTop;\n      var timeTop = setInterval(function () {\n        document.body.scrollTop = document.documentElement.scrollTop = top -= 50;\n\n        if (top <= 0) {\n          clearInterval(timeTop);\n        }\n      }, 10);\n    },\n    updateCartScreen: function updateCartScreen() {\n      var goodsID = this.goodsDetail.ID;\n      var index = 0;\n\n      if (this.$store.state.allDatas.data) {\n        index = this.$store.state.allDatas.data.findIndex(function (item) {\n          return item.ProductID === goodsID;\n        });\n      }\n\n      if (index === -1) {\n        this.$store.commit({\n          type: 'addToCart1',\n          data: this.goodsDetail,\n          num: this.goodsNum\n        });\n      } else {\n        this.$store.commit({\n          type: 'addToCart2',\n          index: index,\n          num: this.goodsNum\n        });\n      }\n    },\n    goComments: function goComments() {\n      this.$router.push('/allComments/' + this.goodsDetail.ID);\n    },\n    goPos: function goPos(index) {\n      switch (index) {\n        case 1:\n          window.scrollTo(0, this.$refs.pos1.offsetTop);\n          break;\n\n        case 2:\n          window.scrollTo(0, this.$refs.pos2.offsetTop - 25);\n          break;\n\n        case 3:\n          window.scrollTo(0, this.$refs.pos3.offsetTop - 25);\n          break;\n\n        default:\n          break;\n      }\n    },\n    onClickChat: function onClickChat() {\n      console.log('通过商家客服id进入聊天界面');\n    }\n  },\n  computed: {\n    totalPrice: function totalPrice() {\n      var total = this.goodsDetail.Price * this.goodsNum;\n      total = parseFloat(total);\n      total = total.toFixed(2);\n      total = total.toLocaleString();\n      return total + \" Block\";\n    },\n    username: function username() {\n      return this.allComments[0].UserName.replace(this.allComments[0].UserName.substring(3, 7), \"****\");\n    },\n    subImages: function subImages() {\n      return this.goodsDetail.SubImages ? JSON.parse(this.goodsDetail.SubImages) : [];\n    },\n    cartInfo: function cartInfo() {\n      return this.$store.state.allDatas.data.length;\n    }\n  },\n  watch: {\n    goodsNum: function goodsNum() {\n      this.goodsNum = this.goodsNum <= this.goodsDetail.Stock ? this.goodsNum : this.goodsDetail.Stock;\n    }\n  },\n  beforeMount: function beforeMount() {\n    this.goodsDetail = this.$store.state.goodsDetail;\n    this.$store.commit(\"requestAllCommentsCount\", 0);\n    this.getAllComments(this.$store.state.requestAllCommentsCount);\n  },\n  mounted: function mounted() {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n};",{"version":3,"sources":["goodsDetail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<div id=\"detail\">\n\t\t\n\t\t<van-nav-bar v-show=\"!showTab\" :border=\"false\" @click-left=\"goBack\" fixed>\n\t\t\t<van-icon class=\"backBtn\" :name=\"backImg\" slot=\"left\" />\n\t\t</van-nav-bar>\n\t\t\n\t\t<transition name=\"fade\" mode=\"out-in\">\n\t\t\t<van-row v-show=\"showTab\"  class=\"hidetab\">\n\t\t\t\t<van-col span=\"4\">\n\t\t\t\t\t<van-icon name=\"arrow-left\" size=\"1.5rem\" @click=\"goBack\"/>\n\t\t\t\t</van-col>\n\t\t\t\t<van-col span=\"16\">\n\t\t\t\t\t<van-button @click=\"goPos(1)\">商品</van-button>\n\t\t\t\t\t<van-button @click=\"goPos(2)\">评价</van-button>\n\t\t\t\t\t<van-button @click=\"goPos(3)\">详情</van-button>\n\t\t\t\t</van-col>\n\t\t\t</van-row>\n\t\t</transition>\n\t\t\n\t\t<div class=\"container\" ref=\"pos1\">\n\t\t\t<van-row>\n\t\t\t\t<van-col span=\"24\">\n\t\t\t\t\t<img class=\"mainImg\" :src=\"goodsDetail.MainImage\">\n\t\t\t\t</van-col>\n\t\t\t</van-row>\n\t\t\t<van-row class=\"price\">\n\t\t\t\t<van-col span=\"24\"><span>{{goodsDetail.Price}}</span>Block</van-col>\n\t\t\t</van-row>\n\t\t\t<van-row class=\"title\">\n\t\t\t\t<van-col span=\"24\">{{goodsDetail.Name}}</van-col>\n\t\t\t</van-row>\n\t\t\t<van-row class=\"desc\">\n\t\t\t\t<van-col span=\"24\">{{goodsDetail.Description}}</van-col>\n\t\t\t</van-row>\n\t\t\t<van-row class=\"icon\">\n\t\t\t\t<van-col span=\"24\">\n\t\t\t\t\t<van-icon :name=\"icon\"/><span>全场包邮</span>\n\t\t\t\t\t<van-icon :name=\"icon\"/><span>7天退换</span>\n\t\t\t\t\t<van-icon :name=\"icon\"/><span>假一赔十</span>\n\t\t\t\t</van-col>\n\t\t\t</van-row>\n\t\t\t<van-cell-group class=\"inventory\">\n\t\t\t\t<van-cell title=\"商品剩余数量:\" :value=\"goodsDetail.Stock\" value-class=\"stockValue\"/>\n\t\t\t</van-cell-group>\n\t\t\t<van-row class=\"quantity\">\n\t\t\t\t<van-col span=\"12\">购买数量：</van-col>\n\t\t\t\t<van-col span=\"12\">\n\t\t\t\t\t<van-stepper v-model=\"goodsNum\" :max=\"goodsDetail.Stock\" integer/>\n\t\t\t\t</van-col>\n\t\t\t</van-row>\n\t\t\t<van-cell-group class=\"totalPrice\">\n\t\t\t\t<van-cell title=\"总价格:\" :value=\"totalPrice\" value-class=\"stockValue\"/>\n\t\t\t</van-cell-group>\n\t\t\t<van-cell-group class=\"commits\" ref=\"pos2\">\n\t\t\t\t<van-cell :title=\"`商品评价(${comments})`\" value=\"查看全部\" is-link @click=\"goComments\"/>\n\t\t\t\t<van-cell class=\"com1\" v-if=\"allComments.length > 0\" :title=\"username\" :value=\"allComments[0].Title\" :label=\"allComments[0].Content\"/>\n\t\t\t\t<van-cell class=\"com2\" v-else title=\"该商品还没有相关评论\" />\n\t\t\t</van-cell-group>\n\t\t\t<span id=\"gd\" ref=\"pos3\">———— 商品详情 ————</span>\n\t\t\t<van-row class=\"subImg\">\n\t\t\t\t<van-col span=\"24\" v-for=\"(item,index) in subImages\" :key=\"index\">\n\t\t\t\t\t<van-image\n\t\t\t\t\t\t:src=\"item.PicUrl\"\n\t\t\t\t\t\tlazy-load\n\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\theight=\"auto\"\n\t\t\t\t\t/>\n\t\t\t\t</van-col>\n\t\t\t</van-row>\n\t\t\t\n\t\t\t<span id=\"gd\">———— 已经到底了 ————</span>\n\t\t\t<van-icon v-if=\"showTab\" class=\"upArrow\" :name=\"upArrow\" size=\"2.5rem\" @click=\"scrollTop\"/>\n\t\t</div>\n\t\t\n\t\t\n\t\n\t\t<van-goods-action>\n\t\t\t<van-goods-action-icon icon=\"chat-o\" text=\"客服\" @click=\"onClickChat\"/>\n\t\t\t<van-goods-action-icon icon=\"cart-o\" text=\"购物车\" :info=\"cartInfo\" @click=\"onCartClick\" />\n\t\t\t<van-goods-action-button type=\"warning\" text=\"加入购物车\" @click=\"onAddToCart\"/>\n\t\t\t<van-goods-action-button type=\"danger\" text=\"立即购买\" @click=\"onBuyClick\"/>\n\t\t</van-goods-action>\n\t\t\n\t</div>\n</template>\n\n<script>\n\timport {NavBar,Icon,Row,Col,Button,Image,CellGroup,Cell,GoodsAction,GoodsActionIcon,GoodsActionButton,Stepper,Toast} from 'vant'\n\timport {Images} from '@/resources/index.js'\n\texport default{\n\t\tcomponents:{\n\t\t\t[NavBar.name]:NavBar,\n\t\t\t[Icon.name]:Icon,\n\t\t\t[Row.name]:Row,\n\t\t\t[Col.name]:Col,\n\t\t\t[Button.name]:Button,\n\t\t\t[Image.name]:Image,\n\t\t\t[CellGroup.name]:CellGroup,\n\t\t\t[Cell.name]:Cell,\n\t\t\t[GoodsAction.name]:GoodsAction,\n\t\t\t[GoodsActionIcon.name]:GoodsActionIcon,\n\t\t\t[GoodsActionButton.name]:GoodsActionButton,\n\t\t\t[Stepper.name]:Stepper,\n\t\t\t[Toast.name]:Toast\n\t\t},\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tbackImg:Images.shop.ic_back,\n\t\t\t\tgoodsDetail:'',\n\t\t\t\tshowTab:false,\n\t\t\t\ticon:Images.shop.ic_item,\n\t\t\t\tgoodsNum:1,\n\t\t\t\tcomments:0,\n\t\t\t\tallComments:[],\n\t\t\t\tupArrow:Images.common.ic_up_arrow,\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tgoBack(){\n\t\t\t\tthis.$store.commit('changeTabbarActive',this.$store.state.fromPage)\n\t\t\t\tthis.$router.back()\n\t\t\t},\n\t\t\tgetAllComments(count){\n\t\t\t\tvar url = '/order/getProductComment?product_id='+this.goodsDetail.ID+'&page='+count\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tif (response.data.status === 1) {\n\t\t\t\t\t\tthis.$store.commit(\"allComments\",response.data.obj)\n\t\t\t\t\t\tthis.allComments = response.data.obj\n\t\t\t\t\t} \n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast(\"网络请求出错\")\n\t\t\t\t})\n\t\t\t},\n\t\t\tonCartClick(){\n\t\t\t\tthis.$router.push('/cart')\n\t\t\t},\n\t\t\tonAddToCart(){\n\t\t\t\tvar url = '/cart/add?user_id='+this.$store.state.userID+'&product_id='+this.goodsDetail.ID+'&quantity='+this.goodsNum+'&token='+this.$store.state.token\n\t\t\t\t// var data = {\n\t\t\t\t// \tuser_id:this.$store.state.userID,\n\t\t\t\t// \tProductID:this.goodsDetail.ID,\n\t\t\t\t// \tQuantity:this.goodsNum,\n\t\t\t\t// \tChecked:true\n\t\t\t\t// }\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tif(response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t}else if (response.data.status === 1) {\n\t\t\t\t\t\tthis.updateCartScreen()\n\t\t\t\t\t\tToast(\"添加成功\")\n\t\t\t\t\t} else{\n\t\t\t\t\t\tToast(\"添加失败，请重试\")\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t},\n\t\t\tonBuyClick(){\n\t\t\t\tvar data = {\n\t\t\t\t\tMainImage:this.goodsDetail.MainImage,\n\t\t\t\t\tName:this.goodsDetail.Name,\n\t\t\t\t\tgoodsNum:this.goodsNum,\n\t\t\t\t\tPrice:this.goodsDetail.Price,\n\t\t\t\t\tgoodsID:this.goodsDetail.ID,\n\t\t\t\t\tStock:this.goodsDetail.Stock\n\t\t\t\t}\n\t\t\t\tthis.$store.commit('confirmOrder',data)\n\t\t\t\tthis.$router.push('/confirmOrder')\n\t\t\t},\n\t\t\thandleScroll(){\n\t\t\t\tvar scrollY = document.documentElement.scrollTop || document.body.scrollTop\n\t\t\t\tif (scrollY > 200) {\n\t\t\t\t\tthis.showTab = true\n\t\t\t\t} else{\n\t\t\t\t\tthis.showTab = false\n\t\t\t\t}\n\t\t\t},\n\t\t\tscrollTop(){\n\t\t\t\tvar top = document.documentElement.scrollTop || document.body.scrollTop\n\t\t\t\tconst timeTop = setInterval(()=>{\n\t\t\t\t\tdocument.body.scrollTop = document.documentElement.scrollTop = top -= 50\n\t\t\t\t\tif (top <= 0) {\n\t\t\t\t\t\tclearInterval(timeTop)\n\t\t\t\t\t}\n\t\t\t\t},10)\n\t\t\t},\n\t\t\tupdateCartScreen(){\n\t\t\t\tvar goodsID = this.goodsDetail.ID\n\t\t\t\tvar index = 0\n\t\t\t\tif (this.$store.state.allDatas.data) {\n\t\t\t\t\tindex = this.$store.state.allDatas.data.findIndex((item)=>{\n\t\t\t\t\t\treturn item.ProductID === goodsID\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tthis.$store.commit({type:'addToCart1',data:this.goodsDetail,num:this.goodsNum})\n\t\t\t\t}else{\n\t\t\t\t\tthis.$store.commit({type:'addToCart2',index:index,num:this.goodsNum})\n\t\t\t\t}\n\t\t\t},\n\t\t\tgoComments(){\n\t\t\t\tthis.$router.push('/allComments/'+this.goodsDetail.ID)\n\t\t\t},\n\t\t\tgoPos(index){\n\t\t\t\tswitch (index){\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\twindow.scrollTo(0,this.$refs.pos1.offsetTop)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\twindow.scrollTo(0,this.$refs.pos2.offsetTop - 25)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\twindow.scrollTo(0,this.$refs.pos3.offsetTop - 25)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonClickChat(){\n\t\t\t\tconsole.log('通过商家客服id进入聊天界面')\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\ttotalPrice(){\n\t\t\t\tvar total = this.goodsDetail.Price * this.goodsNum\n\t\t\t\ttotal = parseFloat(total)\n\t\t\t\ttotal = total.toFixed(2)\n\t\t\t\ttotal = total.toLocaleString()\n\t\t\t\treturn total+\" Block\"\n\t\t\t},\n\t\t\tusername(){\n\t\t\t\treturn this.allComments[0].UserName.replace(this.allComments[0].UserName.substring(3,7),\"****\")\n\t\t\t},\n\t\t\tsubImages(){\n\t\t\t\treturn this.goodsDetail.SubImages ? JSON.parse(this.goodsDetail.SubImages) : []\n\t\t\t},\n\t\t\tcartInfo(){\n\t\t\t\treturn this.$store.state.allDatas.data.length\n\t\t\t}\n\t\t},\n\t\twatch:{\n\t\t\tgoodsNum(){\n\t\t\t\tthis.goodsNum = this.goodsNum <= this.goodsDetail.Stock ? this.goodsNum : this.goodsDetail.Stock\n\t\t\t}\n\t\t},\n\t\tbeforeMount() {\n\t\t\tthis.goodsDetail = this.$store.state.goodsDetail\n\t\t\tthis.$store.commit(\"requestAllCommentsCount\",0)\n\t\t\tthis.getAllComments(this.$store.state.requestAllCommentsCount)\n\t\t},\n\t\tmounted(){\n\t\t\twindow.addEventListener('scroll',this.handleScroll)\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t#detail{\n\t\tbackground: white;\n\t}\n\t.van-nav-bar{\n\t\tbackground: rgba(0,0,0,0);\n\t\tz-index: 1;\n\t}\n\t.backBtn{\n\t\tfont-size: 1.5rem;\n\t}\n\t.hidetab{\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\theight: 2rem;\n\t\tline-height: 2rem;\n\t\tz-index: 1;\n\t\tbackground: white;\n\t}\n\t.hidetab .van-col:first-child{\n\t\ttext-align: left;\n\t\tpadding-left: 0.3125rem;\n\t\tpadding-top: 0.25rem;\n\t}\n\t.hidetab .van-button{\n\t\theight: 2rem;\n\t\tline-height: 2rem;\n\t\tborder: none;\n\t\tbackground: rgba(0,0,0,0);\n\t\tcolor: gray;\n\t}\n\t.container{\n\t\tmargin-bottom: 3.125rem;\n\t}\n\t.mainImg{\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tmax-height: 25rem;\n\t}\n\t.price{\n\t\tcolor: red;\n\t\tfont-size: 0.75rem;\n\t\ttext-align: left;\n\t}\n\t.price span{\n\t\tfont-size: 1.25rem;\n\t\tmargin-left: 0.625rem;\n\t}\n\t.title{\n\t\tfont-size: 0.9375rem;\n\t\ttext-align: left;\n\t\tmargin: 0.3125rem 0.625rem 0;\n\t\tfont-weight: bold;\n\t}\n\t.desc{\n\t\tfont-size: 0.75rem;\n\t\ttext-align: left;\n\t\tmargin: 0.3125rem 0.625rem 0;\n\t\tcolor: #564F5F;\n\t}\n\t.icon{\n\t\ttext-align: left;\n\t\tmargin: 0.3125rem 0.625rem 0;\n\t}\n\t.icon .van-icon{\n\t\tfont-size: 0.625rem;\n\t}\n\t.icon span{\n\t\tmargin-left: 0.3125rem;\n\t\tmargin-right: 0.625rem;\n\t\tfont-size: 0.75rem;\n\t}\n\t.van-cell:after{\n\t\tborder: none;\n\t}\n\t.stockValue{\n\t\tfont-size: 1.25rem;\n\t\tcolor: red;\n\t}\n\t.quantity .van-col{\n\t\tpadding: 0.625rem 1rem;\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.5rem;\n\t}\n\t.quantity .van-col:first-child{\n\t\ttext-align: left;\n\t\tfont-size: 0.9375rem;\n\t}\n\t.quantity .van-col:last-child{\n\t\ttext-align: right;\n\t}\n\t.inventory,.totalPrice,.commits{\n\t\ttext-align: left;\n\t}\n\t.commits .van-cell__value:last-child{\n\t\ttext-align: left;\n\t}\n\t.commits .com2 {\n\t\tfont-size: 0.875rem;\n\t\ttext-align: center;\n\t\tcolor: #999999;\n\t}\n\t#gd{\n\t\ttext-align: center;\n\t\tdisplay: block;\n\t\theight: 1.875rem;\n\t\tline-height: 1.875rem;\n\t\tfont-size: 0.625rem;\n\t\tcolor: gray;\n\t\tbackground: #F5F5F5;\n\t}\n\t.subImg .van-col,.subImg .van-image{\n\t\tborder: 0 none;\n\t\tmargin: 0 0 -3px;\n\t\tpadding: 0;\n\t}\n\t.upArrow{\n\t\tposition: fixed;\n\t\tright: 0.9375rem;\n\t\tbottom: 4.375rem;\n\t}\n</style>\n\n"],"sourceRoot":"src/pages"}]}