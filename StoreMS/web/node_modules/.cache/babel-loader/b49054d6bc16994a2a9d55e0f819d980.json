{"remainingRequest":"/Users/student02/Desktop/youduitong1/node_modules/babel-loader/lib/index.js!/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/student02/Desktop/youduitong1/src/pages/userinfo/userinfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/student02/Desktop/youduitong1/src/pages/userinfo/userinfo.vue","mtime":1569205273000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.typed.uint8-array\";\nimport \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _defineProperty from \"/Users/student02/Desktop/youduitong1/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport \"vant/es/action-sheet/style\";\nimport _ActionSheet from \"vant/es/action-sheet\";\nimport \"vant/es/loading/style\";\nimport _Loading from \"vant/es/loading\";\nimport \"vant/es/overlay/style\";\nimport _Overlay from \"vant/es/overlay\";\nimport \"vant/es/datetime-picker/style\";\nimport _DatetimePicker from \"vant/es/datetime-picker\";\nimport \"vant/es/cell/style\";\nimport _Cell from \"vant/es/cell\";\nimport \"vant/es/cell-group/style\";\nimport _CellGroup from \"vant/es/cell-group\";\nimport \"vant/es/col/style\";\nimport _Col from \"vant/es/col\";\nimport \"vant/es/row/style\";\nimport _Row from \"vant/es/row\";\nimport \"core-js/modules/es6.function.name\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\n\nvar _components;\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Images } from '@/resources/index.js';\nexport default {\n  components: (_components = {}, _defineProperty(_components, _NavBar.name, _NavBar), _defineProperty(_components, _Row.name, _Row), _defineProperty(_components, _Col.name, _Col), _defineProperty(_components, _CellGroup.name, _CellGroup), _defineProperty(_components, _Cell.name, _Cell), _defineProperty(_components, _DatetimePicker.name, _DatetimePicker), _defineProperty(_components, _Overlay.name, _Overlay), _defineProperty(_components, _Loading.name, _Loading), _defineProperty(_components, _ActionSheet.name, _ActionSheet), _defineProperty(_components, _Toast.name, _Toast), _components),\n  data: function data() {\n    return {\n      bg: Images.mineView.ic_bg,\n      border: false,\n      avatar: '',\n      birthday: '',\n      minDate: new Date(1970, 0, 1),\n      maxDate: new Date(),\n      dateBar: false,\n      show: false,\n      loadingText: '修改中...',\n      actionShow: false,\n      closeonclickaction: true,\n      safeareainsetbottom: true,\n      actions: [{\n        name: '从相册选取'\n      }, {\n        name: '拍照'\n      }]\n    };\n  },\n  methods: {\n    goBack: function goBack() {\n      this.$store.commit('changeTabbarActive', 'mine');\n      this.$router.push('/main/mine');\n    },\n    to: function to(name) {\n      if (name === 'modifyNickname') {\n        this.$router.push('/modifyNickname');\n      } else if (name === 'modifyGender') {\n        this.$router.push('/modifyGender');\n      } else if (name === 'modifyEmail') {\n        this.$router.push('/modifyEmail');\n      } else if (name === 'modifyBirthday') {\n        this.dateBar = true;\n      } else {}\n    },\n    modifyBirthday: function modifyBirthday(value) {\n      var _this = this;\n\n      var year = value.getFullYear();\n      var month = value.getMonth() + 1;\n      var day = value.getDate();\n      var birthday = year + '年' + month + '月' + day + '日';\n      this.dateBar = false;\n      this.show = true;\n      this.loadingText = '修改中...';\n      var url = '/user/birth?user_id=' + this.$store.state.userID + '&birth=' + birthday + '&token=' + this.$store.state.token;\n      this.axios.get(url).then(function (response) {\n        if (response.data.detail && response.data.detail == 'token异常，重新登陆') {\n          _Toast('登陆过期，请重新登录');\n\n          _this.$router.push('/login');\n        } else if (response.data.status == 1) {\n          setTimeout(function () {\n            _this.loadingText = response.data.detail;\n\n            _this.$store.commit('birthday', birthday);\n\n            setTimeout(function () {\n              _this.show = false;\n            }, 500);\n          }, 1000);\n        } else {\n          setTimeout(function () {\n            _Toast(response.data.detail);\n\n            _this.show = false;\n          }, 1000);\n        }\n      }).catch(function (response) {\n        setTimeout(function () {\n          _Toast('网络请求出错，请稍候再试!');\n\n          _this.show = false;\n        }, 1000);\n      });\n    },\n    formatter: function formatter(type, value) {\n      if (type === 'year') {\n        return \"\".concat(value, \"\\u5E74\");\n      } else if (type === 'month') {\n        return \"\".concat(value, \"\\u6708\");\n      } else if (type === 'day') {\n        return \"\".concat(value, \"\\u65E5\");\n      }\n\n      return value;\n    },\n    cancel: function cancel() {\n      this.dateBar = false;\n    },\n    showActionSheet: function showActionSheet() {\n      this.actionShow = true;\n    },\n    onSelect: function onSelect(item) {\n      if (item.name === '从相册选取') {\n        this.actionShow = false;\n        this.galleryImgs();\n      }\n\n      if (item.name === '拍照') {\n        this.actionShow = false;\n        this.getImage();\n      }\n    },\n    onCancel: function onCancel() {},\n    galleryImgs: function galleryImgs() {\n      var _this2 = this;\n\n      plus.gallery.pick(function (path) {\n        _this2.imgPreviewnew(path);\n      }, function (e) {\n        _Toast(e.message);\n      }, {\n        filter: \"image\"\n      });\n    },\n    getImage: function getImage() {\n      var _this3 = this;\n\n      var cmr = plus.camera.getCamera();\n      cmr.captureImage(function (p) {\n        plus.io.resolveLocalFileSystemURL(p, function (entry) {\n          var imgUrl = entry.toLocalURL();\n\n          _this3.imgPreviewnew(imgUrl);\n        });\n      }, function (e) {\n        _Toast(e.message);\n      }, {\n        index: 1,\n        filename: '_doc/camera/'\n      });\n    },\n    uploadImage: function uploadImage(file) {\n      var _this4 = this;\n\n      var url = '/user/upload?token=' + this.$store.state.token;\n      var formData = new FormData();\n      formData.append('file', file);\n      formData.append('user_id', this.$store.state.userID);\n      this.axios.post(url, formData).then(function (response) {\n        if (response.data.detail && response.data.detail == 'token异常，重新登陆') {\n          _Toast('登陆过期，请重新登录');\n\n          _this4.$router.push('/login');\n        } else if (response.data.status === 1) {\n          _this4.avatar = response.data.obj + '?v=' + Math.random();\n\n          _this4.$store.commit('avatar', response.data.obj + '?v=' + Math.random());\n\n          _Toast('头像上传成功');\n        } else {\n          _Toast('头像上传失败,请重试');\n        }\n      }).catch(function (response) {\n        _Toast('网络请求出错，请重试');\n      });\n    },\n    imgPreviewnew: function imgPreviewnew(file) {\n      var that = this;\n      var Orientation;\n      var img = new Image();\n      img.src = file;\n\n      img.onload = function () {\n        var base64 = that.compress(img, Orientation); // console.log(data)\n\n        var blob = that.dataURLtoBlob(base64);\n        var file = that.blobToFile(blob, \"image.png\");\n        that.uploadImage(file);\n      };\n    },\n    compress: function compress(img, Orientation) {\n      var canvas = document.createElement(\"canvas\");\n      var ctx = canvas.getContext('2d'); //瓦片canvas\n\n      var tCanvas = document.createElement(\"canvas\");\n      var tctx = tCanvas.getContext(\"2d\");\n      var initSize = img.src.length;\n      var width = img.width;\n      var height = img.height; //如果图片大于四百万像素，计算压缩比并将大小压至400万以下\n\n      var ratio;\n\n      if ((ratio = width * height / 4000000) > 1) {\n        console.log(\"大于400万像素\");\n        ratio = Math.sqrt(ratio);\n        width /= ratio;\n        height /= ratio;\n      } else {\n        ratio = 1;\n      }\n\n      canvas.width = width;\n      canvas.height = height; //        铺底色\n\n      ctx.fillStyle = \"#fff\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height); //如果图片像素大于100万则使用瓦片绘制\n\n      var count;\n\n      if ((count = width * height / 1000000) > 1) {\n        console.log(\"超过100W像素\");\n        count = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片\n        //            计算每块瓦片的宽和高\n\n        var nw = ~~(width / count);\n        var nh = ~~(height / count);\n        tCanvas.width = nw;\n        tCanvas.height = nh;\n\n        for (var i = 0; i < count; i++) {\n          for (var j = 0; j < count; j++) {\n            tctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\n            ctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\n          }\n        }\n      } else {\n        ctx.drawImage(img, 0, 0, width, height);\n      } //修复ios上传图片的时候 被旋转的问题\n\n\n      if (Orientation != \"\" && Orientation != 1) {\n        switch (Orientation) {\n          case 6:\n            //需要顺时针（向左）90度旋转\n            this.rotateImg(img, 'left', canvas);\n            break;\n\n          case 8:\n            //需要逆时针（向右）90度旋转\n            this.rotateImg(img, 'right', canvas);\n            break;\n\n          case 3:\n            //需要180度旋转\n            this.rotateImg(img, 'right', canvas); //转两次\n\n            this.rotateImg(img, 'right', canvas);\n            break;\n        }\n      } //进行最小压缩\n\n\n      var ndata = canvas.toDataURL('image/jpeg', 0.1);\n      console.log('压缩前：' + initSize);\n      console.log('压缩后：' + ndata.length);\n      console.log('压缩率：' + ~~(100 * (initSize - ndata.length) / initSize) + \"%\");\n      tCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\n      return ndata;\n    },\n    dataURLtoBlob: function dataURLtoBlob(dataurl) {\n      var arr = dataurl.split(',');\n      var mime = arr[0].match(/:(.*?);/)[1];\n      var bstr = atob(arr[1]);\n      var n = bstr.length;\n      var u8arr = new Uint8Array(n);\n\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n\n      return new Blob([u8arr], {\n        type: mime\n      });\n    },\n    blobToFile: function blobToFile(blob, fileName) {\n      blob.lastModifiedDate = new Date();\n      blob.name = fileName;\n      return blob;\n    }\n  },\n  mounted: function mounted() {\n    this.avatar = this.$store.state.avatar ? this.$store.state.avatar : Images.mineView.ic_default_head2;\n    var str = this.$store.state.birthday;\n    var len1 = str.indexOf('年');\n    var len2 = str.indexOf('月');\n    var s1 = str.substring(0, len1);\n    var s2 = str.substring(len1 + 1, len2);\n    var s3 = str.substring(len2 + 1, str.length - 1);\n    this.birthday = new Date(s1, s2 - 1, s3);\n  },\n  computed: {\n    getDataList: function getDataList() {\n      return [{\n        image: Images.mineView.ic_info_data[0],\n        title: '昵称',\n        content: this.$store.state.nickname,\n        name: 'modifyNickname'\n      }, {\n        image: Images.mineView.ic_info_data[1],\n        title: '性别',\n        content: this.$store.state.gender,\n        name: 'modifyGender'\n      }, {\n        image: Images.mineView.ic_info_data[2],\n        title: '出生年月',\n        content: this.$store.state.birthday,\n        name: 'modifyBirthday'\n      }, {\n        image: Images.mineView.ic_info_data[3],\n        title: '邮箱',\n        content: this.$store.state.email,\n        name: 'modifyEmail'\n      }, {\n        image: Images.mineView.ic_info_data[4],\n        title: '实名认证',\n        content: '身份证',\n        name: 'Autonym'\n      }];\n    }\n  }\n};",{"version":3,"sources":["userinfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<div id=\"userinfo\">\n\t\t<img :src=\"bg\" class=\"bg\">\n\t\t<van-nav-bar\n\t\t\ttitle=\"个人资料\"\n\t\t\tleft-arrow\n\t\t\tfixed\n\t\t\t@click-left=\"goBack\"\n\t\t\t:border=\"border\"\n\t\t/>\n\t\t\n\t\t<van-row class=\"avatar\">\n\t\t\t<van-col span=\"24\">\n\t\t\t\t<img :src=\"avatar\" @click=\"showActionSheet\">\n\t\t\t\t<!-- <van-image \n\t\t\t\t\t:src=\"avatar\"\n\t\t\t\t\tround\n\t\t\t\t\twidth=\"6.25rem\"\n\t\t\t\t\theight=\"6.25rem\"\n\t\t\t\t\t@click=\"showActionSheet\"\n\t\t\t\t/> -->\n\t\t\t</van-col>\n\t\t</van-row>\n\t\t\n\t\t<van-cell-group class=\"info\">\n\t\t\t<van-cell v-for=\"(item,index) in getDataList\" :key=\"index\"\n\t\t\t\t:icon=\"item.image\"\n\t\t\t\t:title=\"item.title\"\n\t\t\t\t:value=\"item.content\"\n\t\t\t\tis-link\n\t\t\t\t@click='to(item.name)'\n\t\t\t>\n\t\t\t</van-cell>\n\t\t</van-cell-group>\n\t\t\n\t\t<van-datetime-picker \n\t\t\tv-if=\"dateBar\"\n\t\t\tv-model=\"birthday\"\n\t\t\ttype=\"date\"\n\t\t\t:min-date=\"minDate\"\n\t\t\t:max-date=\"maxDate\"\n\t\t\t:formatter=\"formatter\"\n\t\t\t@confirm=\"modifyBirthday\"\n\t\t\t@cancel=\"cancel\"\n\t\t/>\n\t\t\n\t\t<van-action-sheet\n\t\t\tv-model=\"actionShow\"\n\t\t\t:actions=\"actions\"\n\t\t\tcancel-text=\"取消\"\n\t\t\t:close-on-click-action=\"closeonclickaction\"\n\t\t\t:safe-area-inset-bottom=\"safeareainsetbottom\"\n\t\t\t@select=\"onSelect\"\n\t\t\t@cancel=\"onCancel\"\n\t\t/>\n\t\t\n\t\t<van-overlay :show=\"show\" class-name=\"overlay\" />\n\t\t<van-loading v-if=\"show\" vertical>{{loadingText}}</van-loading>\n\n\t</div>\n</template>\n\n<script>\n\timport {Images} from '@/resources/index.js'\n\timport {NavBar,Row,Col,CellGroup,Cell,DatetimePicker,Overlay,Loading,ActionSheet,Toast} from 'vant'\n\texport default{\n\t\tcomponents:{\n\t\t\t[NavBar.name]:NavBar,\n\t\t\t[Row.name]:Row,\n\t\t\t[Col.name]:Col,\n\t\t\t[CellGroup.name]:CellGroup,\n\t\t\t[Cell.name]:Cell,\n\t\t\t[DatetimePicker.name]:DatetimePicker,\n\t\t\t[Overlay.name]:Overlay,\n\t\t\t[Loading.name]:Loading,\n\t\t\t[ActionSheet.name]:ActionSheet,\n\t\t\t[Toast.name]:Toast,\n\t\t},\n\t\tdata(){\n\t\t\treturn{\n\t\t\t\tbg:Images.mineView.ic_bg,\n\t\t\t\tborder:false,\n\t\t\t\tavatar:'',\n\t\t\t\tbirthday:'',\n\t\t\t\tminDate:new Date(1970,0,1),\n\t\t\t\tmaxDate:new Date(),\n\t\t\t\tdateBar:false,\n\t\t\t\tshow:false,\n\t\t\t\tloadingText:'修改中...',\n\t\t\t\tactionShow:false,\n\t\t\t\tcloseonclickaction:true,\n\t\t\t\tsafeareainsetbottom:true,\n\t\t\t\tactions:[\n\t\t\t\t\t{name:'从相册选取'},\n\t\t\t\t\t{name:'拍照'}\n\t\t\t\t],\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tgoBack(){\n\t\t\t\tthis.$store.commit('changeTabbarActive','mine')\n\t\t\t\tthis.$router.push('/main/mine')\n\t\t\t},\n\t\t\tto(name){\n\t\t\t\tif (name === 'modifyNickname') {\n\t\t\t\t\tthis.$router.push('/modifyNickname')\n\t\t\t\t} else if (name === 'modifyGender') {\n\t\t\t\t\tthis.$router.push('/modifyGender')\n\t\t\t\t} else if (name === 'modifyEmail') {\n\t\t\t\t\tthis.$router.push('/modifyEmail')\n\t\t\t\t} else if (name === 'modifyBirthday') {\n\t\t\t\t\tthis.dateBar = true\n\t\t\t\t} else{\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t},\n\t\t\tmodifyBirthday(value){\n\t\t\t\tvar year = value.getFullYear()\n\t\t\t\tvar month = value.getMonth()+1\n\t\t\t\tvar day = value.getDate()\n\t\t\t\tvar birthday = year+'年'+month+'月'+day+'日'\n\t\t\t\tthis.dateBar = false\n\t\t\t\tthis.show = true\n\t\t\t\tthis.loadingText = '修改中...'\n\t\t\t\tvar url = '/user/birth?user_id='+this.$store.state.userID+'&birth='+birthday+'&token='+this.$store.state.token\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tif (response.data.detail && response.data.detail == 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t}else if (response.data.status == 1) {\n\t\t\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\t\t\tthis.loadingText = response.data.detail\n\t\t\t\t\t\t\tthis.$store.commit('birthday',birthday)\n\t\t\t\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\t\t\t\tthis.show = false\n\t\t\t\t\t\t\t},500)\n\t\t\t\t\t\t},1000)\n\t\t\t\t\t} else{\n\t\t\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\t\t\tToast(response.data.detail)\n\t\t\t\t\t\t\tthis.show = false\n\t\t\t\t\t\t},1000)\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\t\tToast('网络请求出错，请稍候再试!')\n\t\t\t\t\t\tthis.show = false\n\t\t\t\t\t},1000)\n\t\t\t\t})\n\t\t\t},\n\t\t\tformatter(type,value){\n\t\t\t\tif(type === 'year'){\n\t\t\t\t\treturn `${value}年`\n\t\t\t\t}else if(type === 'month'){\n\t\t\t\t\treturn `${value}月`\n\t\t\t\t}else if(type === 'day'){\n\t\t\t\t\treturn `${value}日`\n\t\t\t\t}\n\t\t\t\treturn value\n\t\t\t},\n\t\t\tcancel(){\n\t\t\t\tthis.dateBar = false\n\t\t\t},\n\t\t\tshowActionSheet(){\n\t\t\t\tthis.actionShow = true\n\t\t\t},\n\t\t\tonSelect(item){\n\t\t\t\tif (item.name === '从相册选取') {\n\t\t\t\t\tthis.actionShow = false\n\t\t\t\t\tthis.galleryImgs()\n\t\t\t\t}\n\t\t\t\tif (item.name === '拍照') {\n\t\t\t\t\tthis.actionShow = false\n\t\t\t\t\tthis.getImage()\n\t\t\t\t}\n\t\t\t},\n\t\t\tonCancel(){\n\t\t\t\t\n\t\t\t},\n\t\t\tgalleryImgs(){\n\t\t\t\tplus.gallery.pick((path)=>{\n\t\t\t\t\tthis.imgPreviewnew(path)\n\t\t\t\t},(e)=>{\n\t\t\t\t\tToast(e.message)\n\t\t\t\t},{\n\t\t\t\t\tfilter:\"image\"\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetImage(){\n\t\t\t\tvar cmr = plus.camera.getCamera()\n\t\t\t\tcmr.captureImage((p)=>{\n\t\t\t\t\tplus.io.resolveLocalFileSystemURL(p,(entry)=>{\n\t\t\t\t\t\tvar imgUrl = entry.toLocalURL()\n\t\t\t\t\t\tthis.imgPreviewnew(imgUrl)\n\t\t\t\t\t})\n\t\t\t\t},(e)=>{\n\t\t\t\t\t\tToast(e.message)\n\t\t\t\t},{\n\t\t\t\t\tindex:1,\n\t\t\t\t\tfilename:'_doc/camera/'\n\t\t\t\t})\n\t\t\t},\n\t\t\tuploadImage(file){\n\t\t\t\tvar url = '/user/upload?token=' + this.$store.state.token\n\t\t\t\tvar formData = new FormData()\n\t\t\t\tformData.append('file',file)\n\t\t\t\tformData.append('user_id',this.$store.state.userID)\n\t\t\t\tthis.axios.post(url,formData).then((response)=>{\n\t\t\t\t\tif (response.data.detail && response.data.detail == 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t}else if(response.data.status === 1){\n\t\t\t\t\t\tthis.avatar = response.data.obj+'?v='+Math.random()\n\t\t\t\t\t\tthis.$store.commit('avatar',response.data.obj+'?v='+Math.random())\n\t\t\t\t\t\tToast('头像上传成功')\n\t\t\t\t\t} else{\n\t\t\t\t\t\tToast('头像上传失败,请重试')\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t},\n\t\t\timgPreviewnew(file){\n\t\t\t\tlet that = this\n\t\t\t\tlet Orientation\n\t\t\t\tlet img = new Image()\n\t\t\t\timg.src = file\n\t\t\t\timg.onload = function(){\n\t\t\t\t\tlet base64 = that.compress(img,Orientation)\n\t\t\t\t\t// console.log(data)\n\t\t\t\t\tlet blob = that.dataURLtoBlob(base64)\n\t\t\t\t\tvar file = that.blobToFile(blob,\"image.png\")\n\t\t\t\t\tthat.uploadImage(file)\n\t\t\t\t}\n\t\t\t},\n\t\t\tcompress(img,Orientation) {\n\t\t\t\tlet canvas = document.createElement(\"canvas\");\n\t\t\t\tlet ctx = canvas.getContext('2d');\n\t\t\t\t//瓦片canvas\n\t\t\t\tlet tCanvas = document.createElement(\"canvas\");\n\t\t\t\tlet tctx = tCanvas.getContext(\"2d\");\n\t\t\t\tlet initSize = img.src.length;\n\t\t\t\tlet width = img.width;\n\t\t\t\tlet height = img.height;\n\t\t\t\t//如果图片大于四百万像素，计算压缩比并将大小压至400万以下\n\t\t\t\tlet ratio;\n\t\t\t\tif ((ratio = width * height / 4000000) > 1) {\n\t\t\t\t\tconsole.log(\"大于400万像素\")\n\t\t\t\t\tratio = Math.sqrt(ratio);\n\t\t\t\t\twidth /= ratio;\n\t\t\t\t\theight /= ratio;\n\t\t\t\t} else {\n\t\t\t\t\tratio = 1;\n\t\t\t\t}\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t\t//        铺底色\n\t\t\t\tctx.fillStyle = \"#fff\";\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t\t//如果图片像素大于100万则使用瓦片绘制\n\t\t\t\tlet count;\n\t\t\t\tif ((count = width * height / 1000000) > 1) {\n\t\t\t\t\tconsole.log(\"超过100W像素\");\n\t\t\t\t\tcount = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片\n\t\t\t\t\t//            计算每块瓦片的宽和高\n\t\t\t\t\tlet nw = ~~(width / count);\n\t\t\t\t\tlet nh = ~~(height / count);\n\t\t\t\t\ttCanvas.width = nw;\n\t\t\t\t\ttCanvas.height = nh;\n\t\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\t\tfor (let j = 0; j < count; j++) {\n\t\t\t\t\t\t\ttctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\n\t\t\t\t\t\t\tctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tctx.drawImage(img, 0, 0, width, height);\n\t\t\t\t}\n\t\t\t\t//修复ios上传图片的时候 被旋转的问题\n\t\t\t\tif(Orientation != \"\" && Orientation != 1){\n\t\t\t\t\tswitch(Orientation){\n\t\t\t\t\t\tcase 6://需要顺时针（向左）90度旋转\n\t\t\t\t\t\t\tthis.rotateImg(img,'left',canvas);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 8://需要逆时针（向右）90度旋转\n\t\t\t\t\t\t\tthis.rotateImg(img,'right',canvas);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 3://需要180度旋转\n\t\t\t\t\t\t\tthis.rotateImg(img,'right',canvas);//转两次\n\t\t\t\t\t\t\tthis.rotateImg(img,'right',canvas);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//进行最小压缩\n\t\t\t\tlet ndata = canvas.toDataURL('image/jpeg', 0.1);\n\t\t\t\tconsole.log('压缩前：' + initSize);\n\t\t\t\tconsole.log('压缩后：' + ndata.length);\n\t\t\t\tconsole.log('压缩率：' + ~~(100 * (initSize - ndata.length) / initSize) + \"%\");\n\t\t\t\ttCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\n\t\t\t\treturn ndata;\n\t\t\t},\n\t\t\tdataURLtoBlob(dataurl){\n\t\t\t\tvar arr = dataurl.split(',')\n\t\t\t\tvar mime = arr[0].match(/:(.*?);/)[1]\n\t\t\t\tvar bstr = atob(arr[1])\n\t\t\t\tvar n = bstr.length\n\t\t\t\tvar u8arr = new Uint8Array(n)\n\t\t\t\twhile (n--){\n\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n)\n\t\t\t\t}\n\t\t\t\treturn new Blob([u8arr],{type:mime})\n\t\t\t},\n\t\t\tblobToFile(blob,fileName){\n\t\t\t\tblob.lastModifiedDate = new Date()\n\t\t\t\tblob.name = fileName\n\t\t\t\treturn blob\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\tthis.avatar = this.$store.state.avatar ? this.$store.state.avatar : Images.mineView.ic_default_head2\n\t\t\tvar str = this.$store.state.birthday\n\t\t\tlet len1 = str.indexOf('年')\n\t\t\tlet len2 = str.indexOf('月')\n\t\t\tlet s1 = str.substring(0,len1)\n\t\t\tlet s2 = str.substring(len1+1,len2)\n\t\t\tlet s3 = str.substring(len2+1,str.length-1)\n\t\t\tthis.birthday = new Date(s1,s2-1,s3)\n\t\t},\n\t\tcomputed:{\n\t\t\tgetDataList(){\n\t\t\t\treturn (\n\t\t\t\t\t[\n\t\t\t\t\t\t{image:Images.mineView.ic_info_data[0],title:'昵称',content:this.$store.state.nickname,name:'modifyNickname'},\n\t\t\t\t\t\t{image:Images.mineView.ic_info_data[1],title:'性别',content:this.$store.state.gender,name:'modifyGender'},\n\t\t\t\t\t\t{image:Images.mineView.ic_info_data[2],title:'出生年月',content:this.$store.state.birthday,name:'modifyBirthday'},\n\t\t\t\t\t\t{image:Images.mineView.ic_info_data[3],title:'邮箱',content:this.$store.state.email,name:'modifyEmail'},\n\t\t\t\t\t\t{image:Images.mineView.ic_info_data[4],title:'实名认证',content:'身份证',name:'Autonym'}\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.bg{\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 7.5rem;\n\t\tz-index: -1;\n\t}\n\t.van-nav-bar{\n\t\tbackground: rgba(0,0,0,0);\n\t}\n\t.van-nav-bar__arrow{\n\t\tcolor: #fff;\n\t\tfont-size: 1.5rem;\n\t}\n\t.van-nav-bar__title{\n\t\tcolor: white;\n\t}\n\t.avatar{\n\t\tmargin-top: 3.75rem;\n\t}\n\t.avatar img{\n\t\twidth:6.25rem;\n\t\theight:6.25rem;\n\t\tborder-radius:50%;\n\t\tborder: 0.0625rem solid #F2F3F5;\n\t}\n\t.info{\n\t\tmargin: 0.625rem 0.625rem 0 0.625rem;\n\t\tborder-radius: 0.5rem;\n\t\toverflow: hidden;\n\t}\n\t.info .van-cell{\n\t\ttext-align: left;\n\t}\n\t.van-overlay{\n\t\tbackground: rgba(0,0,0,0);\n\t}\n</style>\n"],"sourceRoot":"src/pages/userinfo"}]}