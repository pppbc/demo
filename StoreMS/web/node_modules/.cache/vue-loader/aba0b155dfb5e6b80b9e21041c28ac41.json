{"remainingRequest":"/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/student02/Desktop/youduitong1/src/pages/cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/student02/Desktop/youduitong1/src/pages/cart.vue","mtime":1571123385000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/student02/Desktop/youduitong1/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {NavBar,Checkbox,Image,Stepper,Button,Row,Col,SubmitBar,Toast} from 'vant'\nexport default{\n\tcomponents:{\n\t\t[NavBar.name]:NavBar,\n\t\t[Checkbox.name]:Checkbox,\n\t\t[Image.name]:Image,\n\t\t[Stepper.name]:Stepper,\n\t\t[Button.name]:Button,\n\t\t[Row.name]:Row,\n\t\t[Col.name]:Col,\n\t\t[SubmitBar.name]:SubmitBar,\n\t\t[Toast.name]:Toast\n\t},\n\tdata(){\n\t\treturn {\n\t\t\tcheckAll:true,\n\t\t\tcartList:[],\n\t\t}\n\t},\n\tmethods:{\n\t\tgoBack(){\n\t\t\tthis.$store.commit('changeTabbarActive',this.$store.state.fromPage)\n\t\t\tthis.$router.back()\n\t\t},\n\t\tonSubmit(){\n\t\t\tvar hasChecked = this.$store.state.allDatas.data.every(val=>{\n\t\t\t\treturn val.Checked === false\n\t\t\t})\n\t\t\tif (!hasChecked) {\n\t\t\t\tthis.$router.push('/confirmOrder')\n\t\t\t}else{\n\t\t\t\tToast('还没有选择商品')\n\t\t\t}\n\t\t},\n\t\tchange(item,index){\n\t\t\tvar data ={\n\t\t\t\tUserID:this.$store.state.userID,\n\t\t\t\tProductID:item.ProductID,\n\t\t\t\tQuantity:item.Quantity,\n\t\t\t\tChecked:item.Checked\n\t\t\t}\n\t\t\tvar url = '/car/update?token='+this.$store.state.token\n\t\t\tthis.axios.post(url,data).then((response)=>{\n\t\t\t\tif(response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t}else if (response.data.status === 1) {\n\t\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\t\tif (val['Checked']) {\n\t\t\t\t\t\t\tthis.checkAll = true\n\t\t\t\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthis.checkAll = false\n\t\t\t\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).catch((response)=>{\n\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t})\n\t\t},\n\t\tgetUserCartDetail(){\n\t\t\tvar url = '/cart/get?user_id='+this.$store.state.userID+'&token='+this.$store.state.token\n\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\tif(response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t}else\tif(response.data.status === 1) {\n\t\t\t\t\tthis.cartList = response.data.info\n\t\t\t\t\tthis.$store.commit('allDatasData',response.data.info)\n\t\t\t\t}\n\t\t\t}).catch((response)=>{\n\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t})\n\t\t},\n\t\tcheckedAll(){\n\t\t\tthis.checkAll = !this.checkAll\n\t\t\tif (this.checkAll) {\n\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\tval['Checked'] = true\n\t\t\t\t}\n\t\t\t} else{\n\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\tval['Checked'] = false\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar url = '/product/checkAll?user_id='+this.$store.state.userID+'&state='+this.checkAll+'&token='+this.$store.state.token\n\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t}).catch((response)=>{\n\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t})\n\t\t},\n\t\tdeleteFromCart(id,index){\n\t\t\tvar url = '/product/deleteProduct?id='+id+'&token='+this.$store.state.token\n\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\tif (response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t} else if(response.data.status === 1){\n\t\t\t\t\tthis.$store.commit('deleteFromCartLocal',index)\n\t\t\t\t\tToast('删除成功')\n\t\t\t\t} else {\n\t\t\t\t\tToast('删除失败，请重试')\n\t\t\t\t}\n\t\t\t}).catch((response)=>{\n\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t})\n\t\t}\n\t},\n\tbeforeMount(){\n\t\tthis.$store.commit('allDatasData',[])\n\t\tthis.checkAll = this.$store.state.checkAll\n\t\tthis.getUserCartDetail()\n\t},\n\tcomputed:{\n\t\ttotalPrice(){\n\t\t\tvar totalPrice = 0\n\t\t\tfor (let item of this.cartList) {\n\t\t\t\tif (item.Checked) {\n\t\t\t\t\ttotalPrice += (item.Price * item.Quantity)*100\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn totalPrice\n\t\t}\n\t}\n}\n",{"version":3,"sources":["cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n\t<div>\n\t\t<van-nav-bar\n\t\t\ttitle=\"购物车\"\n\t\t\tleft-arrow\n\t\t\tfixed\n\t\t\t@click-left=\"goBack\"\n\t\t/>\n\t\t\n\t\t<van-row class=\"main\">\n\t\t\t<van-col class=\"content\" span=\"24\" v-for=\"(item,index) in cartList\" :key=\"index\">\n\t\t\t\t<van-row>\n\t\t\t\t\t<van-col class=\"check\" span=\"2\">\n\t\t\t\t\t\t<van-checkbox v-model=\"item.Checked\" @change=\"change(item,index)\" checked-color=\"#ff0000\"></van-checkbox>\n\t\t\t\t\t</van-col>\n\t\t\t\t\t<van-col class=\"img\" span=\"8\">\n\t\t\t\t\t\t<van-image :src=\"item.MainImage\" width=\"5rem\" height=\"5rem\"/>\n\t\t\t\t\t</van-col>\n\t\t\t\t\t<van-col class=\"right\" span=\"14\">\n\t\t\t\t\t\t<van-row class=\"prdname\">\n\t\t\t\t\t\t\t<van-col span=\"24\">{{item.ProductName}}</van-col>\n\t\t\t\t\t\t</van-row>\n\t\t\t\t\t\t<van-row class=\"price\">\n\t\t\t\t\t\t\t<van-col span=\"14\">Block:{{item.Price*item.Quantity}}</van-col>\n\t\t\t\t\t\t\t<van-col span=\"10\">x{{item.Quantity}}</van-col>\n\t\t\t\t\t\t</van-row>\n\t\t\t\t\t\t<van-row class=\"opera\">\n\t\t\t\t\t\t\t<van-col span=\"14\">\n\t\t\t\t\t\t\t\t<van-stepper v-model=\"item.Quantity\" disable-input @change=\"change(item,index)\"></van-stepper>\n\t\t\t\t\t\t\t</van-col>\n\t\t\t\t\t\t\t<van-col span=\"10\">\n\t\t\t\t\t\t\t\t<van-button type=\"danger\" @click=\"deleteFromCart(item.ID,index)\">删除</van-button>\n\t\t\t\t\t\t\t</van-col>\n\t\t\t\t\t\t</van-row>\n\t\t\t\t\t</van-col>\n\t\t\t\t</van-row>\n\t\t\t</van-col>\n\t\t</van-row>\n\t\t\n\t\t<van-submit-bar\n\t\t\t:price=\"totalPrice\"\n\t\t\tcurrency=\"B\"\n\t\t\tbutton-text=\"去结算\"\n\t\t\t@submit=\"onSubmit\"\n\t\t\tsafe-area-inset-bottom\n\t\t>\n\t\t\t<van-checkbox v-model=\"checkAll\" @click=\"checkedAll\" checked-color=\"#ff0000\">全选</van-checkbox>\n\t\t</van-submit-bar>\n\t\t\n\t</div>\n</template>\n\n<script>\n\timport {NavBar,Checkbox,Image,Stepper,Button,Row,Col,SubmitBar,Toast} from 'vant'\n\texport default{\n\t\tcomponents:{\n\t\t\t[NavBar.name]:NavBar,\n\t\t\t[Checkbox.name]:Checkbox,\n\t\t\t[Image.name]:Image,\n\t\t\t[Stepper.name]:Stepper,\n\t\t\t[Button.name]:Button,\n\t\t\t[Row.name]:Row,\n\t\t\t[Col.name]:Col,\n\t\t\t[SubmitBar.name]:SubmitBar,\n\t\t\t[Toast.name]:Toast\n\t\t},\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\tcheckAll:true,\n\t\t\t\tcartList:[],\n\t\t\t}\n\t\t},\n\t\tmethods:{\n\t\t\tgoBack(){\n\t\t\t\tthis.$store.commit('changeTabbarActive',this.$store.state.fromPage)\n\t\t\t\tthis.$router.back()\n\t\t\t},\n\t\t\tonSubmit(){\n\t\t\t\tvar hasChecked = this.$store.state.allDatas.data.every(val=>{\n\t\t\t\t\treturn val.Checked === false\n\t\t\t\t})\n\t\t\t\tif (!hasChecked) {\n\t\t\t\t\tthis.$router.push('/confirmOrder')\n\t\t\t\t}else{\n\t\t\t\t\tToast('还没有选择商品')\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange(item,index){\n\t\t\t\tvar data ={\n\t\t\t\t\tUserID:this.$store.state.userID,\n\t\t\t\t\tProductID:item.ProductID,\n\t\t\t\t\tQuantity:item.Quantity,\n\t\t\t\t\tChecked:item.Checked\n\t\t\t\t}\n\t\t\t\tvar url = '/car/update?token='+this.$store.state.token\n\t\t\t\tthis.axios.post(url,data).then((response)=>{\n\t\t\t\t\tif(response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t}else if (response.data.status === 1) {\n\t\t\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\t\t\tif (val['Checked']) {\n\t\t\t\t\t\t\t\tthis.checkAll = true\n\t\t\t\t\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.checkAll = false\n\t\t\t\t\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t},\n\t\t\tgetUserCartDetail(){\n\t\t\t\tvar url = '/cart/get?user_id='+this.$store.state.userID+'&token='+this.$store.state.token\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tif(response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t}else\tif(response.data.status === 1) {\n\t\t\t\t\t\tthis.cartList = response.data.info\n\t\t\t\t\t\tthis.$store.commit('allDatasData',response.data.info)\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t},\n\t\t\tcheckedAll(){\n\t\t\t\tthis.checkAll = !this.checkAll\n\t\t\t\tif (this.checkAll) {\n\t\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\t\tval['Checked'] = true\n\t\t\t\t\t}\n\t\t\t\t} else{\n\t\t\t\t\tfor (let val of this.cartList) {\n\t\t\t\t\t\tval['Checked'] = false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar url = '/product/checkAll?user_id='+this.$store.state.userID+'&state='+this.checkAll+'&token='+this.$store.state.token\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tthis.$store.commit('checkAll',this.checkAll)\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteFromCart(id,index){\n\t\t\t\tvar url = '/product/deleteProduct?id='+id+'&token='+this.$store.state.token\n\t\t\t\tthis.axios.get(url).then((response)=>{\n\t\t\t\t\tif (response.data.detail && response.data.detail === 'token异常，重新登陆') {\n\t\t\t\t\t\tToast('登陆过期，请重新登录')\n\t\t\t\t\t\tthis.$router.push('/login')\n\t\t\t\t\t} else if(response.data.status === 1){\n\t\t\t\t\t\tthis.$store.commit('deleteFromCartLocal',index)\n\t\t\t\t\t\tToast('删除成功')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tToast('删除失败，请重试')\n\t\t\t\t\t}\n\t\t\t\t}).catch((response)=>{\n\t\t\t\t\tToast('网络请求出错，请重试')\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tbeforeMount(){\n\t\t\tthis.$store.commit('allDatasData',[])\n\t\t\tthis.checkAll = this.$store.state.checkAll\n\t\t\tthis.getUserCartDetail()\n\t\t},\n\t\tcomputed:{\n\t\t\ttotalPrice(){\n\t\t\t\tvar totalPrice = 0\n\t\t\t\tfor (let item of this.cartList) {\n\t\t\t\t\tif (item.Checked) {\n\t\t\t\t\t\ttotalPrice += (item.Price * item.Quantity)*100\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn totalPrice\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t.van-nav-bar__arrow{\n\t\tfont-size: 1.5rem;\n\t\tcolor: #000000;\n\t}\n\t.main{\n\t\tmargin: 3.125rem 0.625rem;\n\t}\n\t.content{\n\t\tbackground: white;\n\t\tborder-radius: 0.5rem;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 0.625rem;\n\t\theight: 6.25rem;\n\t}\n\t\n\t.check .van-checkbox{\n\t\tmargin: 2.5rem 0 0 0.5rem;\n\t}\n\t.img .van-image{\n\t\tmargin-top: 0.625rem;\n\t}\n\t.prdname{\n\t\ttext-align: left;\n\t\tfont-size: 0.75rem;\n\t\tcolor: #999999;\n\t\tpadding: 0.625rem 0.625rem 0 0;\n\t}\n\t.prdname .van-col{\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t}\n\t.price{\n\t\ttext-align: left;\n\t\tfont-size: 0.875rem;\n\t\tpadding: 0.625rem 0.625rem 0 0;\n\t}\n\t.price .van-col:first-child{\n\t\tcolor: red;\n\t}\n\t.price .van-col:last-child{\n\t\ttext-align: center;\n\t\tcolor: #999999;\n\t}\n\t.opera{\n\t\tpadding: 0.625rem 0.625rem 0 0;\n\t}\n\t.opera .van-button{\n\t\theight: 1.75rem;\n\t\tline-height: 1.75rem;\n\t}\n\t.van-submit-bar .van-checkbox{\n\t\tmargin-left: 0.625rem;\n\t}\n</style>\n"]}]}